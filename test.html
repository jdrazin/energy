<html>
<head>
    <meta http-equiv="refresh" content="30">
    <!--Load the AJAX API-->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">                                       // see https://www.digitalocean.com/community/tutorials/how-to-use-the-javascript-fetch-api-to-get-data
    const SERVER    = 'https://www.drazin.net:8443/control/';
    const user      = getParameterByName('user');
    const password  = getParameterByName('password');
    const token     = '?token=' + encodeURIComponent(getParameterByName('token'));
    const headers   = new Headers({
        "Authorization": "Basic " + btoa(`${user}:${password}`)
    });
    function slot_command() {
        var url = SERVER + 'slots' + token;
        fetch(url, { method: "GET", headers: headers })
            .then(response => response.text()) // First get response as text
            .then(text => {
                if (!text) throw new Error("Empty response from server");
                return text;
            })
            .then(data => drawChart(data))
            .catch(error => console.error('Error fetching data:', error));
    }
    </script>
</head>
<body>
<div id="chart_time_series"></div>
<div id="table_tariff_combinations"></div>
</body>
</html>
